# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
## Данные и типы данных, используемые в приложении

**Продукт**
```
interface IProduct {
    id: string;
    title: string;
    category: string;
    description: string;
    price: number | null; 
    image: string;
}
```
**Данные об оплате**
```
interface IPayment {
    adress: string;
    telNum: string;
    email: string;
    paymentType: string;
}
```

## Архитектура приложения
Код приложения разделен на слои согласно парадигме MVP: 
- слой представления, отвечает за отображение данных на странице, 
- слой данных, отвечает за хранение и изменение данных
- презентер, отвечает за связь представления и данных.

### Базовый код

#### Класс Api
Содержит в себе базовую логику отправки запросов. В конструктор передается базовый адрес сервера и опциональный объект с заголовками запросов.
Методы: 
- get - выполняет GET запрос на переданный в параметрах ендпоинт и возвращает промис с объектом, которым ответил сервер
- post - принимает объект с данными, которые будут переданы в JSON в теле запроса, и отправляет эти данные на ендпоинт переданный как параметр при вызове метода. По умолчанию выполняется POST запрос, но метод запроса может быть переопределен заданием третьего параметра при вызове.

#### Класс EventEmitter
Брокер событий позволяет отправлять события и подписываться на события, происходящие в системе. Класс используется в презентере для обработки событий и в слоях приложения для генерации событий.  
Основные методы, реализуемые классом описаны интерфейсом IEvents:
- on - подписка на событие
- emit - инициализация события
- trigger - возвращает функцию, при вызове которой инициализируется требуемое в параметрах событие

## Слой данных
### Класс IBasketData
Отвечает за храение и логику работы с данными карзины пользователя.\
В полях классах храняться следующие данные:
- products: IProduct[] - массив карточек товаров;
- totalPrice: number - итоговая сумма корзины;
- events: IEvents - экземпляр класса `EventEmitter` для инициации событий при изменении данных.

Набор методов, для дальнейшего взаимодейтсивя с данными:
- addProduct(product: IProduct): void - добавление товара в корзину;
- deleteProduct(product: IProduct): void - удаление товара из корзины;
- getTotalPrice(): number - метод для подсчета итоговой стоимости корзины.

### Класс IPaymentData
Класс отвечает за хранение данных об оплате и логику работы.
Содержит следующие поля:
- adress: string - адрес покупателя;
- telNum: string - контактный номер покупателя;
- email: string - эл. почта покупателя;
- paymentType: string - тип оплаты;

Набор методов:
- setAdress() - задает значение поля Адрес;
- setTelNum() - задает значение поля Контактный номер;
- setEmail() - задает значение поля Эл. почты;
- setPaymentType() - задает значение выбранный тип оплаты.

## Слой отображения

#### Класс Modal
Реализует модальное окно. 

- constructor(selector: string, events: IEvents) Конструктор принимает селектор, по которому в разметке страницы будет идентифицировано модальное окно и экземпляр класса EventEmitter для возможности инициации событий.

Поля класса
- modal: HTMLElement - элемент модального окна;
- events: IEvents - брокер событий.

Методы класса:
- open() - открытие модального окна;
- close() - закрытие модального окна.

#### Класс Product
Отвечает за отображение карточки товара.
Методы:
- setData(Product: IProduct): void - заполняет атрибуты элементов карточки данными;
- deleteProduct(): void - удаление карточки продукта
- renderProduct() - возвращает карточку с заполненными данными.

#### Класс BasketBol ;)
Класс отвечающий за отображение корзины.

Поля:
- productContainer: HTMLElement - элемент дом дерева с карточками товаров;
- render() - метод для отображения корзины
 
#### Класс ProductsContainer
Отвечает за отображение блока с карточками на главной странице. Предоставляет метод addCard(ProductElement: HTMLElement) для добавления карточек на страницу и сеттер container для полного обновления содержимого. В конструктор принимает контейнер, в котором размещаются карточки.

### Класс PaymentForm:
Окно формы с типом оплаты и адресом.

Поля:
- cardPayment: HTMLElement - кнопка оплаты картой;
- cashPayment: HTMLElement - кнопка оплаты наличными;
- address: HTMLElement - ввод адреса;
- render() - отображение формы.

### Класс InfoForm:
Окно формы для заполнения Эл.адреса и контактного телефона покупателя.

Поля: 
- phone: HTMLElement - поле ввода контактного телефона;
- email: HTMLElement - поле ввода Эл. почты.

Методы:
- render() - отображение формы.

### Слой коммуникации

#### Класс AppApi
Принимает в конструктор экземпляр класса Api и предоставляет методы реализующие взаимодействие с бэкендом сервиса.

## Взаимодействие компонентов
Код, описывающий взаимодействие представления и данных между собой находится в файле index.ts, выполняющем роль презентера.\
Взаимодействие осуществляется за счет событий генерируемых с помощью брокера событий и обработчиков этих событий, описанных в `index.ts`\
В `index.ts` сначала создаются экземпляры всех необходимых классов, а затем настраивается обработка событий.

## Размещение в сети
Рабочая версия проекта размещена по адресу: https://